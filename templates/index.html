<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-commerce Fraud Detection</title>
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
     <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body>
    
    {% extends 'base.html' %}
    {% block title %}Home - Fraud Detection{% endblock %}
    {% block content %}

    <!--Home Section-->
    <section class="home-content" id="home">
        <div class="main-content">
            <h1 class="main-topic">Fraud Guard</h1>
            <h2 class="home-para">AI-Powered E-Commerce Fraud Detection System</h2>
            <a href="#predict" class="detect-btn">Start Detecting</a>
        </div>
        <div class="main-img">
            <div class="fraud-image">
                <img src="{{ url_for('static', filename='images/fraud.jpeg') }}" alt="Home Image">

            </div>
        </div>
        
    <!-- Slant Background -->
    </section>
    <div class="slant-background"></div>

    <!--Predict Section-->
    <section class="predict-container" id="predict">
        <h1 class="predict-title">Predict a Transaction</h1>
        <h2 class="predict-subtitle">Enter Transaction details to detect fraud</h2>
        <form action="/predict" method="POST" class="my-form" id="predictionForm" autocomplete="off">
            <fieldset>
                <legend>Customer Details</legend>
                <div class="form-row">
                    <!-- Source -->
                    <div class="form-group col-md-3">
                        <label for="source">Source:</label>
                        <select class="form-control" id="source" name="source" required>
                            <option selected disabled>----select option----</option>
                            <option value="0" {% if source == "0" %}selected{% endif %}>Seo</option>
                            <option value="1" {% if source == "1" %}selected{% endif %}>Ads</option>
                            <option value="2" {% if source == "2" %}selected{% endif %}>Direct</option>
                        </select>
                    </div>

                    <!-- Browser -->
                    <div class="form-group col-md-3">
                        <label for="browser">Browser:</label>
                        <select class="form-control" id="browser" name="browser" required>
                            <option selected disabled>----select option----</option>
                            <option value="0" {% if browser == "0" %}selected{% endif %}>Chrome</option>
                            <option value="1" {% if browser == "1" %}selected{% endif %}>Opera</option>
                            <option value="2" {% if browser == "2" %}selected{% endif %}>Safari</option>
                            <option value="3" {% if browser == "3" %}selected{% endif %}>IE</option>
                            <option value="4" {% if browser == "4" %}selected{% endif %}>Firefox</option>
                        </select>
                    </div>

                    <!-- Sex -->
                    <div class="form-group col-md-3">
                        <label for="sex">Sex:</label>
                        <select class="form-control" id="sex" name="sex" required>
                            <option selected disabled>----select option----</option>
                            <option value="1" {% if sex == "1" %}selected{% endif %}>Male</option>
                            <option value="0" {% if sex == "0" %}selected{% endif %}>Female</option>
                        </select>
                    </div>

                    <!-- Age -->
                    <div class="form-group col-md-3">
                        <label for="age">Age:</label>
                        <input type="number" class="form-control" id="age" name="age" value="{{ age }}" required>
                    </div>                
                </div>
            </fieldset>
            <fieldset>
                <legend>Transaction Details</legend>
                <div class="form-row">
                    <!-- Country Name -->
                    <div class="form-group col-md-3">
                        <label for="country_name">Country Name:</label>
                        <select name="country_name" id="country_name" class="form-control">
                            {% for country in country_names %}
                                <option value="{{ country }}" {% if country == country_name %}selected{% endif %}>{{ country }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- No of Device Occur -->
                    <div class="form-group col-md-3">
                        <label for="n_device_occur">No of Device Occur:</label>
                        <input type="number" class="form-control" id="n_device_occur" name="n_device_occur" value="{{ n_device_occur }}" required>
                    </div>

                    <!-- Signup Month -->
                    <div class="form-group col-md-3">
                        <label for="signup_month">Signup Month:</label>
                        <input type="number" class="form-control" id="signup_month" name="signup_month" value="{{ signup_month }}" required>
                    </div>

                    <!-- Signup Day -->
                    <div class="form-group col-md-3">
                        <label for="signup_day">Signup Day:</label>
                        <input type="number" class="form-control" id="signup_day" name="signup_day" value="{{ signup_day }}" required>
                    </div>
                </div>

                <div class="form-row">
                    <!-- Signup Day Name -->
                    <div class="form-group col-md-3">
                        <label for="signup_day_name">Signup Day Name:</label>
                        <select name="signup_day_name" id="signup_day_name" class="form-control">
                            {% for day in signup_day_names %}
                                <option value="{{ day }}" {% if day == signup_day_name %}selected{% endif %}>{{ day }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Purchase Month -->
                    <div class="form-group col-md-3">
                        <label for="purchase_month">Purchase Month:</label>
                        <input type="number" class="form-control" id="purchase_month" name="purchase_month" value="{{ purchase_month }}" required>
                    </div>

                    <!-- Purchase Day -->
                    <div class="form-group col-md-3">
                        <label for="purchase_day">Purchase Day:</label>
                        <input type="number" class="form-control" id="purchase_day" name="purchase_day" value="{{ purchase_day }}" required>
                    </div>

                    <!-- Purchase Day Name -->
                    <div class="form-group col-md-3">
                        <label for="purchase_day_name">Purchase Day Name:</label>
                        <select name="purchase_day_name" id="purchase_day_name" class="form-control">
                            {% for day in purchase_day_names %}
                                <option value="{{ day }}" {% if day == purchase_day_name %}selected{% endif %}>{{ day }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <!-- Purchase Over Time -->
                    <div class="form-group col-md-3">
                        <label for="purchase_over_time">Purchase Over Time:</label>
                        <input type="number" step="0.01" class="form-control" id="purchase_over_time" name="purchase_over_time" value="{{ purchase_over_time }}" required>
                    </div>
                </div>
            </fieldset>
            <div class="predict-btn">
            <button type="submit" class="btn btn-primary mt-4">Predict</button>
            <button type="button"class="btn btn-primary mt-4" onclick="clearForm()">Clear Form</button>
            </div>
        </form>
        </div>
        {% if  prediction is not none %}

        <div id="predictionModal" class="modal" style="display:block">
            <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <h2>Prediction Result:</h2>
                    
                <p><strong>Transaction ID:</strong> <span class="txn-id">{{ transaction_id }}</span></p>
                <p><strong>Risk Score:</strong> <span class="txn-id">{{ risk_score }}%</span></p>

                {% if prediction == 1 %}
                    <div class="result fraud"><i class="bi bi-exclamation-triangle-fill"></i>Fraud Transaction Detected</div>
                {% else %}
                    <div class="result legal"><i class="bi bi-shield-fill-check"></i>Legal Transaction</div>
                {% endif %}
            </div>
        </div>
        {% endif %}
    {% endblock %}
    </section>
</body>
</html>